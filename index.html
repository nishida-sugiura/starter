<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>LIFF Starter</title>
        <link rel="stylesheet" href="style.css">
    </head>
    <body>
        <div id="liffAppContent">
            <!-- ACTION BUTTONS -->
            <div class="buttonGroup">
               
                
                
                
                
                
                
                
                
                <div class="buttonRow">    
                    <button id="getProfileButton">Get Profile</button>
                </div>
                
          <div class="buttonRow">
                    <button id="shareTargetPicker">Open Share Target Picker</button>
                </div>
            </div>

            
            
            
            
            
            
            
            
            
            
            

            <!-- PROFILE INFO -->
            <div id="profileInfo" class="hidden textLeft">
                <h2>Profile</h2>
                <a href="#" onclick="toggleProfileData()">Close Profile</a>
                <div id="profilePictureDiv">
                </div>
                <table>
                    <tr>
                        <th>userId</th>
                        <td id="userIdProfileField"></td>
                    </tr>
                    <tr>
                        <th>displayName</th>
                        <td id="displayNameField"></td>
                    </tr>
                    <tr>
                        <th>statusMessage</th>
                        <td id="statusMessageField"></td>
                    </tr>
                </table>
            </div>
            <!-- LIFF DATA -->
            <div id="liffData">
                <h2 id="liffDataHeader" class="textLeft">LIFF Data</h2>
               
                
                
                 <table>
                    <tr>
                        <th>OS</th>
                        <td id="deviceOS" class="textLeft"></td>
                    </tr>
                    <tr>
                        <th>Language</th>
                        <td id="browserLanguage" class="textLeft"></td>
                    </tr>
                    <tr>
                        <th>LIFF SDK Version</th>
                        <td id="sdkVersion" class="textLeft"></td>
                    </tr>
                    <tr>
                        <th>LINE Version</th>
                        <td id="lineVersion" class="textLeft"></td>
                    </tr>
                    <tr>
                        <th>isInClient</th>
                        <td id="isInClient" class="textLeft"></td>
                    </tr>
                    <tr>
                        <th>isLoggedIn</th>
                        <td id="isLoggedIn" class="textLeft"></td>
                    </tr>
                </table>
                
                
                
                
                
                
                
                
            </div>
            <!-- LOGIN LOGOUT BUTTONS -->
            <div class="buttonGroup">
                <button id="liffLoginButton">Log in</button>
                <button id="liffLogoutButton">Log out</button>
            </div>
            <div id="statusMessage">
                <div id="isInClientMessage"></div>
                <div id="apiReferenceMessage">
                    <p>Available LIFF methods vary depending on the browser you use to open the LIFF app.</p>
                    <p>Please refer to the <a href="https://developers.line.biz/en/reference/liff/#initialize-liff-app">API reference page</a> for more information.</p>
                </div>
            </div>
        </div>
        <!-- LIFF ID ERROR -->
        <div id="liffIdErrorMessage" class="hidden">
            <p>You have not assigned any value for LIFF ID.</p>
            <p>If you are running the app using Node.js, please set the LIFF ID as an environment variable in your Heroku account follwing the below steps: </p>
            <code id="code-block">
                <ol>
                    <li>Go to `Dashboard` in your Heroku account.</li>
                    <li>Click on the app you just created.</li>
                    <li>Click on `Settings` and toggle `Reveal Config Vars`.</li>
                    <li>Set `MY_LIFF_ID` as the key and the LIFF ID as the value.</li>
                    <li>Your app should be up and running. Enter the URL of your app in a web browser.</li>
                </ol>
            </code>
            <p>If you are using any other platform, please add your LIFF ID in the <code>index.html</code> file.</p>
            <p>For more information about how to add your LIFF ID, see <a href="https://developers.line.biz/en/reference/liff/#initialize-liff-app">Initializing the LIFF app</a>.</p>
        </div>
        <!-- LIFF INIT ERROR -->
        <div id="liffInitErrorMessage" class="hidden">
            <p>Something went wrong with LIFF initialization.</p>
            <p>LIFF initialization can fail if a user clicks "Cancel" on the "Grant permission" screen, or if an error occurs in the process of <code>liff.init()</code>.</p>
        </div>
        <!-- NODE.JS LIFF ID ERROR -->
        <div id="nodeLiffIdErrorMessage" class="hidden">
            <p>Unable to receive the LIFF ID as an environment variable.</p>
        </div>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <p>デポジット用のIDを入力してください。<br></p>


  <textarea id="textArea" rows="1" cols="12"></textarea>


   <button id="postButton" onclick="">送信する</button>
  <br>
  <button id="getButton">確認する</button>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
        
        
        
        
        
        
        
  <script>
      
   liff.getProfile()
  .then((profile) => {
    const dsp_name = profile.displayName;
    const uid = profile.userId;
  })
  .catch((err) => {
    console.log("error", err);
  });
      
      
      
      
      
      
      
      

    //GAS WebアプリのURL

//const END_POINT ="https://script.google.com/macros/s/AKfycbzaxbellO8xgR3KCMqzfLkzYpg8ZC-mJbodMkDiTh9fJyujdy59zhxirp0FAkvzTE3F/exec";

const END_POINT = "https://script.google.com/macros/s/AKfycby4ibg1Y_JZv7yPMPjqglSPfqOwK4R43ju2qu5-PcqVsfByfd1uAPB2bLUctZrWwZU7/exec";

    //読み書きするスプレッドシート（タブ）の番号
    const SHEET_NO = 1; 
    document.getElementById("postButton").addEventListener('click', postToGAS, false);
    document.getElementById("getButton").addEventListener('click', getFromGAS, false);
    let dataObj = {};
    function postToGAS() {
      const Content0 = document.getElementById("textArea").value.trim();
      console.log(Content0);

//let Content = [];
        
        
        
        
        
        

let Content =JSON.stringify([Content0]);
//let Content =JSON.stringify([uid]);       
        
        
        
        
        
        
        
        
        
        
        


      //データがJSONかどうかのチェック
      try {
       const checkJSON = JSON.parse(Content);
     

 if (checkJSON.length > 0 && Object.keys(checkJSON).length > 0) {
        console.log("data is OK");
       } else {
         throw "data is not array of object";
       }

     }

      catch (e) {
        alert("error:" + e);
        return;
      }
      //POST送信
      $.ajax({
        type: "POST",
        url: END_POINT,
        dataType: "json",
        data: { sheetNo: SHEET_NO, data: Content }
      })
        .then(
          (result) => { // 成功した時の処理
            console.log(JSON.stringify(result));
          },
          (error) => { // 失敗した時の処理
            alert('Error:' + JSON.stringify(error));
          }
        );
    }
    function getFromGAS() {
      $.ajax({
        type: "GET",
        url: END_POINT,
        data: { sheetNo: SHEET_NO }
      }).done((result) => {        // 成功した時の処理
        dataObj = JSON.parse(result);
        document.getElementById("textArea").value = result;
        console.log("get done:" + result);
      }).fail((error) => {  // 失敗した時の処理
        alert('Error:' + JSON.stringify(error));
      }).always((data) => {// 常にやる処理
        // do something
      });
    }
      
//function clearTextarea() {
//	var textareaForm = document.getElementById("textArea");
// textareaForm.value = '';}

  </script>

        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
       <script src="liff-starter.js"></script>
    </body>
</html>

